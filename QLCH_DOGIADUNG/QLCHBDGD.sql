CREATE DATABASE QLCHBDGD
USE QLCHBDGD



CREATE  TABLE KHACHHANG(
    MAKH CHAR(10) PRIMARY KEY, --MAKH SINH TU DONG
    TENKH NVARCHAR(50) NOT NULL,
    SDT CHAR(10) NOT NULL,
	DIACHI NVARCHAR(100) NOT NULL
)

CREATE TABLE NHANVIEN(
    MANV CHAR(10) PRIMARY KEY,
    MATKHAU CHAR(10) NOT NULL,
    TENNV NVARCHAR(50) NOT NULL,
	SDT CHAR(10) NOT NULL,
    NGAYSINH DATETIME NOT NULL,
	DIACHI NVARCHAR(100) NOT NULL,
)
CREATE TABLE NHAPP(
MANPP CHAR(10) PRIMARY KEY,
  MALSP CHAR(10) NOT NULL FOREIGN KEY REFERENCES LOAISP(MALSP)
   ON DELETE CASCADE ON UPDATE CASCADE,
TENNPP NVARCHAR(50) NOT NULL,
SDT CHAR(10) NOT NULL,
DIACHI NVARCHAR(50) NOT NULL
)
 
CREATE TABLE THUONGHIEU(
MATH CHAR(10) PRIMARY KEY,
TENTH NVARCHAR(50) NOT NULL,
)
CREATE TABLE SANPHAM(
    MASP CHAR(10) PRIMARY KEY,
    TENSP NVARCHAR(50)NOT NULL,

   MATH CHAR(10) NOT NULL FOREIGN KEY REFERENCES	 THUONGHIEU(MATH)
   ON DELETE CASCADE ON UPDATE CASCADE,
     MALSP CHAR(10) NOT NULL FOREIGN KEY REFERENCES	 LOAISP(MALSP)
  ,
	SOLUONG INT NOT NULL,
	GIANHAP FLOAT NOT NULL,
    GIABAN FLOAT NOT NULL,
)

CREATE TABLE HOADONNHAP(
    MAHDN CHAR(10) PRIMARY KEY,
	MANPP CHAR(10) NOT NULL  FOREIGN KEY REFERENCES	 NHAPP(MANPP), 
	  MANV CHAR(10) NOT NULL FOREIGN KEY REFERENCES NHANVIEN(MANV)
   ON DELETE CASCADE ON UPDATE CASCADE,

	NGAYNHAP DATETIME,

)


CREATE TABLE CHITIETHDN(
    MAHDN char(10) NOT NULL  FOREIGN KEY REFERENCES HOADONNHAP(MAHDN)
   ON DELETE CASCADE ON UPDATE CASCADE,
    MASP CHAR(10) NOT NULL  FOREIGN KEY REFERENCES SANPHAM(MASP)
   ON DELETE CASCADE ON UPDATE CASCADE,
    SOLUONG INT,
    GIANHAP FLOAT,
	
)

select HOADONNHAP.MAHDN,CHITIETHDN.MASP,HOADONNHAP.NGAYNHAP,HOADONNHAP.MANV,HOADONNHAP.MANPP,CHITIETHDN.SOLUONG,CHITIETHDN.GIANHAP from HOADONNHAP inner join CHITIETHDN on HOADONNHAP.MAHDN = CHITIETHDN.MAHDN  where HOADONNHAP.MAHDN = 'HDN01'
CREATE TABLE HOADONBAN(
    MAHDB CHAR(10) PRIMARY KEY,
    NGAYBAN DATETIME NOT NULL,
     MANV CHAR(10) NOT NULL FOREIGN KEY REFERENCES NHANVIEN(MANV)
   ON DELETE CASCADE ON UPDATE CASCADE,
    MAKH CHAR(10) NOT NULL FOREIGN KEY REFERENCES KHACHHANG(MAKH)
   ON DELETE CASCADE ON UPDATE CASCADE,
)



CREATE TABLE CHITIETHDB(
    MAHDB CHAR(10) NOT NULL FOREIGN KEY REFERENCES HOADONBAN(MAHDB)
   ON DELETE CASCADE ON UPDATE CASCADE,
    MASP CHAR(10) NOT NULL FOREIGN KEY REFERENCES SANPHAM(MASP)
   ON DELETE CASCADE ON UPDATE CASCADE,
    SOLUONG INT,
	GIABAN FLOAT,
	
)
CREATE TABLE LOAISP(
MALSP CHAR(10) PRIMARY KEY,
TENLSP NVARCHAR(100) NOT NULL,
)
CREATE TABLE THANHTOAN (
    MAHDB char(10) NOT NULL FOREIGN KEY REFERENCES HOADONBAN(MAHDB)
   ON DELETE CASCADE ON UPDATE CASCADE,
   
    NGAYBAN DATETIME NOT NULL,
    TENKH NVARCHAR(50) NOT NULL,
    TENNV NVARCHAR(50) NOT NULL,
    SOLUONG INT NOT NULL,
    TONGTIEN FLOAT NOT NULL
)
CREATE TABLE THANHTOANHDN (
    MAHDN char(10) NOT NULL FOREIGN KEY REFERENCES HOADONNHAP(MAHDN)
   ON DELETE CASCADE ON UPDATE CASCADE,
   
    NGAYNHAP DATETIME NOT NULL,
    TENNPP NVARCHAR(50) NOT NULL,
    TENNV NVARCHAR(50) NOT NULL,
    SOLUONG INT NOT NULL,
    TONGTIEN FLOAT NOT NULL
)
DROP TABLE THANHTOANHDN
SELECT SUM(THANHTOAN.SOLUONG) AS [TỔNG SẢN PHẨM ĐÃ BÁN], SUM(THANHTOAN.TONGTIEN * THANHTOAN.SOLUONG) AS [TỔNG DOANH THU]
FROM THANHTOAN
WHERE NGAYBAN BETWEEN '2023-05-29' AND '2023-05-31';
select *from THANHTOAN
--INSERT DU LIEU
--KHACH HANG
INSERT INTO KHACHHANG VALUES('KH1',N'VƯƠNG ĐỨC TUẤN','0135451251',N'CẨM GIÀNG-HẢII DƯƠNG')
INSERT INTO KHACHHANG VALUES('KH2',N'NGUYỄN VĂN TRƯỜNG','0153541252',N'KHOÁI CHÂU-HƯNG YÊN')
INSERT INTO KHACHHANG VALUES('KH3',N'ĐINH QUỐC TRUNG','0135541254',N'THÀNH PHỐ HƯNG YÊN')
INSERT INTO KHACHHANG VALUES('KH4',N'PHẠM TIẾN THÀNH','0135454251',N'ÂN THI-HƯNG YÊN')
INSERT INTO KHACHHANG VALUES('KH5',N'HOÀNG NGUYỆT NHI','0135541251',N'ÂN THI-HƯNG YÊN')
INSERT INTO KHACHHANG VALUES('KH6',N'VŨ MINH HIẾU','0130012551',N'PHÚ THỌ')
INSERT INTO KHACHHANG VALUES('KH7',N'DƯƠNG ĐỨC NGUYÊN','0135541111',N'THÀNH PHỐ HƯNG YÊN')
INSERT INTO KHACHHANG VALUES('KH8',N'VƯƠNG ĐỨC DŨNG','0135415251',N'CẨM GIÀNG-HẢI DƯƠNG')
INSERT INTO KHACHHANG VALUES('KH9',N'PHẠM THỊ ÁNH NGỌC','0135441251',N'NINH BÌNH')
INSERT INTO KHACHHANG VALUES('KH10',N'NGUYỂN THÚY HIỀN','0134541231',N'KHOÁI CHÂU-HƯNG YÊN')
--NHANVIEN
DELETE FROM KHACHHANG
GO
INSERT INTO NHANVIEN VALUES('NV1','123','NGUYEN THANH A','0123456789','2001/03/15','HUNG YEN');
INSERT INTO NHANVIEN VALUES('NV2','123','NGUYEN THANH B','0126465441','2000/03/15','HUNG YEN');
INSERT INTO NHANVIEN VALUES('NV3','123','NGUYEN THANH C','0123423423','2002/03/15','HUNG YEN');
INSERT INTO NHANVIEN VALUES('NV4','123','NGUYEN THANH D','0123632667','2003/03/15','HUNG YEN');
INSERT INTO NHANVIEN VALUES('NV5','123','NGUYEN THANH E','0123147437','2001/04/15','HUNG YEN');
INSERT INTO NHANVIEN VALUES('NV6','123','NGUYEN THANH G','0123096376','2001/09/15','HUNG YEN');
INSERT INTO NHANVIEN VALUES('NV7','123','NGUYEN THANH H','0123738423','2001/04/15','HUNG YEN');
INSERT INTO NHANVIEN VALUES('NV8','123','NGUYEN THANH I','0123501364','2001/01/15','HUNG YEN');
INSERT INTO NHANVIEN VALUES('NV9','123','NGUYEN THANH K','0123763823','2001/09/15','HUNG YEN');
INSERT INTO NHANVIEN VALUES('NV10','123','NGUYEN THANH L','0126346734','2001/12/15','HUNG YEN');
--NHA PHAN PHOI
INSERT INTO NHAPP VALUES('NPP01','LSP01',N'HOÀNG GIANG','0135412554',N'THÀNH PH? H?NG YÊN')
INSERT INTO NHAPP VALUES('NPP02','LSP02',N'GIA ĐỊNH','0135442515',N'ÂN THI-H?NG YÊN')
INSERT INTO NHAPP VALUES('NPP03','LSP03',N'HÙNG TÀU','0135412515',N'ÂN THI-H?NG YÊN')
INSERT INTO NHAPP VALUES('NPP04','LSP04',N'CHÍ PHÈO','0130012515',N'PHÚ THỌ')
-- THUONG HIEU
INSERT INTO THUONGHIEU VALUES('TH01','LG');
INSERT INTO THUONGHIEU VALUES('TH02','KITCHENAID');
INSERT INTO THUONGHIEU VALUES('TH03','KANGAROO');
INSERT INTO THUONGHIEU VALUES('TH04','PHILIPS');
INSERT INTO THUONGHIEU VALUES('TH05','SUNHOUES');
INSERT INTO THUONGHIEU VALUES('TH06','PANASONIC');
--SAN PHAM
INSERT INTO SANPHAM VALUES ('SP1',N'TI VI','TH01','LSP01',500,1000,1200);
INSERT INTO SANPHAM VALUES ('SP2',N'BỘ BÀN GHẾ SOFA','TH02','LSP01',200,1300,1500);
INSERT INTO SANPHAM VALUES ('SP3',N'BỘ BẾP GIA ĐÌNH','TH03','LSP02',3000,1600,2000);
INSERT INTO SANPHAM VALUES ('SP4',N'BỘ HÚT MÙI PHÒNG BẾP','TH04','LSP02',1000,400,600);
INSERT INTO SANPHAM VALUES ('SP5',N'BỘ GIƯỜNG GỖ CAO CẤP','TH05','LSP03',1500,2500,3000);
INSERT INTO SANPHAM VALUES ('SP6',N'ĐIỀU HÒA','TH06','LSP03',100,1000,1500);
INSERT INTO SANPHAM VALUES ('SP7',N'BỘ VÒI XỊT NƯỚC PHÒNG TẮM','TH01','LSP04',200,350,450);
INSERT INTO SANPHAM VALUES ('SP8',N'BỒN TẮM','TH02','LSP04',700,250,350);

--LOAI SAN PHAM
INSERT INTO LOAISP VALUES ('LSP01',N'ĐỒ GIA DỤNG PHÒNG KHÁCH');
INSERT INTO LOAISP VALUES ('LSP02',N'ĐỒ GIA DỤNG PHÒNG BẾP');
INSERT INTO LOAISP VALUES ('LSP03',N'ĐỒ GIA DỤNG PHÒNG NGỦ');
INSERT INTO LOAISP VALUES ('LSP04',N'ĐỒ GIA DỤNG PHÒNG TẮM');



SELECT * FROM HOADONNHAP
--HOADONHAP
INSERT INTO HOADONNHAP   VALUES('HDN01','NPP01','NV1',GETDATE())
INSERT INTO HOADONNHAP   VALUES('HDN02','NPP02',GETDATE())
INSERT INTO HOADONNHAP   VALUES('HDN03','NPP03',GETDATE())
INSERT INTO HOADONNHAP   VALUES('HDN04','NPP04',GETDATE())
INSERT INTO HOADONNHAP   VALUES('HDN05','NPP01',GETDATE())
INSERT INTO HOADONNHAP   VALUES('HDN06','NPP02',GETDATE())
INSERT INTO HOADONNHAP   VALUES('HDN07','NPP03',GETDATE())
INSERT INTO HOADONNHAP   VALUES('HDN08','NPP04',GETDATE())
--CTHOADONNHAP
INSERT INTO CHITIETHDN VALUES ('HDN01','SP1',10,1000)
INSERT INTO CHITIETHDN VALUES ('HDN02','SP2',11,1300)
INSERT INTO CHITIETHDN VALUES ('HDN03','SP3',12,1600)
INSERT INTO CHITIETHDN VALUES ('HDN04','SP4',13,400)
INSERT INTO CHITIETHDN VALUES ('HDN05','SP5',14,2500)
INSERT INTO CHITIETHDN VALUES ('HDN06','SP6',15,1000)
INSERT INTO CHITIETHDN VALUES ('HDN07','SP7',16,350)
INSERT INTO CHITIETHDN VALUES ('HDN08','SP8',17,250)



--HOADONBAN
INSERT INTO HOADONBAN  VALUES('HDB01',GETDATE(),'NV1','KH1')
INSERT INTO HOADONBAN  VALUES('HDB02',GETDATE(),'NV2','KH2')
INSERT INTO HOADONBAN  VALUES('HDB03',GETDATE(),'NV3','KH3')
INSERT INTO HOADONBAN  VALUES('HDB04',GETDATE(),'NV4','KH4')
INSERT INTO HOADONBAN  VALUES('HDB05',GETDATE(),'NV5','KH5')
INSERT INTO HOADONBAN  VALUES('HDB06',GETDATE(),'NV6','KH6')
INSERT INTO HOADONBAN  VALUES('HDB07',GETDATE(),'NV7','KH7')
INSERT INTO HOADONBAN  VALUES('HDB08',GETDATE(),'NV8','KH8')
INSERT INTO HOADONBAN  VALUES('HDB09',GETDATE(),'NV9','KH9')
INSERT INTO HOADONBAN  VALUES('HDB10',GETDATE(),'NV10','KH10')



--CTHOADONBAN
INSERT INTO CHITIETHDB VALUES ('HDB01','SP1',1,1200)
INSERT INTO CHITIETHDB VALUES ('HDB02','SP2',1,1500)
INSERT INTO CHITIETHDB VALUES ('HDB03','SP3',2,2000)
INSERT INTO CHITIETHDB VALUES ('HDB04','SP4',1,600)
INSERT INTO CHITIETHDB VALUES ('HDB05','SP5',4,3000)
INSERT INTO CHITIETHDB VALUES ('HDB06','SP6',1,1500)
INSERT INTO CHITIETHDB VALUES ('HDB07','SP7',1,460)
INSERT INTO CHITIETHDB VALUES ('HDB08','SP8',3,350)
INSERT INTO CHITIETHDB VALUES ('HDB09','SP4',2,600)
INSERT INTO CHITIETHDB VALUES ('HDB10','SP3',1,2000)